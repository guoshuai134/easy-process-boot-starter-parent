webpackJsonp([0],{"+E39":function(e,t,n){e.exports=!n("S82l")(function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a})},"+ZMJ":function(e,t,n){var s=n("lOnJ");e.exports=function(e,t,n){if(s(e),void 0===t)return e;switch(n){case 1:return function(n){return e.call(t,n)};case 2:return function(n,s){return e.call(t,n,s)};case 3:return function(n,s,r){return e.call(t,n,s,r)}}return function(){return e.apply(t,arguments)}}},"+tPU":function(e,t,n){n("xGkn");for(var s=n("7KvD"),r=n("hJx8"),i=n("/bQp"),o=n("dSzd")("toStringTag"),a="CSSRuleList,CSSStyleDeclaration,CSSValueList,ClientRectList,DOMRectList,DOMStringList,DOMTokenList,DataTransferItemList,FileList,HTMLAllCollection,HTMLCollection,HTMLFormElement,HTMLSelectElement,MediaList,MimeTypeArray,NamedNodeMap,NodeList,PaintRequestList,Plugin,PluginArray,SVGLengthList,SVGNumberList,SVGPathSegList,SVGPointList,SVGStringList,SVGTransformList,SourceBufferList,StyleSheetList,TextTrackCueList,TextTrackList,TouchList".split(","),l=0;l<a.length;l++){var c=a[l],u=s[c],p=u&&u.prototype;p&&!p[o]&&r(p,o,c),i[c]=i.Array}},"/bQp":function(e,t){e.exports={}},"06OY":function(e,t,n){var s=n("3Eo+")("meta"),r=n("EqjI"),i=n("D2L2"),o=n("evD5").f,a=0,l=Object.isExtensible||function(){return!0},c=!n("S82l")(function(){return l(Object.preventExtensions({}))}),u=function(e){o(e,s,{value:{i:"O"+ ++a,w:{}}})},p=e.exports={KEY:s,NEED:!1,fastKey:function(e,t){if(!r(e))return"symbol"==typeof e?e:("string"==typeof e?"S":"P")+e;if(!i(e,s)){if(!l(e))return"F";if(!t)return"E";u(e)}return e[s].i},getWeak:function(e,t){if(!i(e,s)){if(!l(e))return!0;if(!t)return!1;u(e)}return e[s].w},onFreeze:function(e){return c&&p.NEED&&l(e)&&!i(e,s)&&u(e),e}}},"0tT4":function(e,t){},"2KxR":function(e,t){e.exports=function(e,t,n,s){if(!(e instanceof t)||void 0!==s&&s in e)throw TypeError(n+": incorrect invocation!");return e}},"3C/1":function(e,t,n){n("M6a0"),n("zQR9"),n("+tPU"),n("qCoq"),n("UvrK"),n("Xjd4"),n("bqnK"),e.exports=n("FeBl").Map},"3Eo+":function(e,t){var n=0,s=Math.random();e.exports=function(e){return"Symbol(".concat(void 0===e?"":e,")_",(++n+s).toString(36))}},"3fs2":function(e,t,n){var s=n("RY/4"),r=n("dSzd")("iterator"),i=n("/bQp");e.exports=n("FeBl").getIteratorMethod=function(e){if(void 0!=e)return e[r]||e["@@iterator"]||i[s(e)]}},"4WTo":function(e,t,n){var s=n("NWt+");e.exports=function(e,t){var n=[];return s(e,!1,n.push,n,t),n}},"4mcu":function(e,t){e.exports=function(){}},"52gC":function(e,t){e.exports=function(e){if(void 0==e)throw TypeError("Can't call method on  "+e);return e}},"54na":function(e,t){},"5lMD":function(e,t){},"77Pl":function(e,t,n){var s=n("EqjI");e.exports=function(e){if(!s(e))throw TypeError(e+" is not an object!");return e}},"7Doy":function(e,t,n){var s=n("EqjI"),r=n("7UMu"),i=n("dSzd")("species");e.exports=function(e){var t;return r(e)&&("function"!=typeof(t=e.constructor)||t!==Array&&!r(t.prototype)||(t=void 0),s(t)&&null===(t=t[i])&&(t=void 0)),void 0===t?Array:t}},"7I/A":function(e,t){},"7KvD":function(e,t){var n=e.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=n)},"7OT6":function(e,t){},"7UMu":function(e,t,n){var s=n("R9M2");e.exports=Array.isArray||function(e){return"Array"==s(e)}},"880/":function(e,t,n){e.exports=n("hJx8")},"8j1d":function(e,t){},"94VQ":function(e,t,n){"use strict";var s=n("Yobk"),r=n("X8DO"),i=n("e6n0"),o={};n("hJx8")(o,n("dSzd")("iterator"),function(){return this}),e.exports=function(e,t,n){e.prototype=s(o,{next:r(1,n)}),i(e,t+" Iterator")}},"9Bbf":function(e,t,n){"use strict";var s=n("kM2E");e.exports=function(e){s(s.S,e,{of:function(){for(var e=arguments.length,t=new Array(e);e--;)t[e]=arguments[e];return new this(t)}})}},"9C8M":function(e,t,n){"use strict";var s=n("evD5").f,r=n("Yobk"),i=n("xH/j"),o=n("+ZMJ"),a=n("2KxR"),l=n("NWt+"),c=n("vIB/"),u=n("EGZi"),p=n("bRrM"),f=n("+E39"),d=n("06OY").fastKey,h=n("LIJb"),v=f?"_s":"size",m=function(e,t){var n,s=d(t);if("F"!==s)return e._i[s];for(n=e._f;n;n=n.n)if(n.k==t)return n};e.exports={getConstructor:function(e,t,n,c){var u=e(function(e,s){a(e,u,t,"_i"),e._t=t,e._i=r(null),e._f=void 0,e._l=void 0,e[v]=0,void 0!=s&&l(s,n,e[c],e)});return i(u.prototype,{clear:function(){for(var e=h(this,t),n=e._i,s=e._f;s;s=s.n)s.r=!0,s.p&&(s.p=s.p.n=void 0),delete n[s.i];e._f=e._l=void 0,e[v]=0},delete:function(e){var n=h(this,t),s=m(n,e);if(s){var r=s.n,i=s.p;delete n._i[s.i],s.r=!0,i&&(i.n=r),r&&(r.p=i),n._f==s&&(n._f=r),n._l==s&&(n._l=i),n[v]--}return!!s},forEach:function(e){h(this,t);for(var n,s=o(e,arguments.length>1?arguments[1]:void 0,3);n=n?n.n:this._f;)for(s(n.v,n.k,this);n&&n.r;)n=n.p},has:function(e){return!!m(h(this,t),e)}}),f&&s(u.prototype,"size",{get:function(){return h(this,t)[v]}}),u},def:function(e,t,n){var s,r,i=m(e,t);return i?i.v=n:(e._l=i={i:r=d(t,!0),k:t,v:n,p:s=e._l,n:void 0,r:!1},e._f||(e._f=i),s&&(s.n=i),e[v]++,"F"!==r&&(e._i[r]=i)),e},getEntry:m,setStrong:function(e,t,n){c(e,t,function(e,n){this._t=h(e,t),this._k=n,this._l=void 0},function(){for(var e=this._k,t=this._l;t&&t.r;)t=t.p;return this._t&&(this._l=t=t?t.n:this._t._f)?u(0,"keys"==e?t.k:"values"==e?t.v:[t.k,t.v]):(this._t=void 0,u(1))},n?"entries":"values",!n,!0),p(t)}}},"A5f+":function(e,t){},ALrJ:function(e,t,n){var s=n("+ZMJ"),r=n("MU5D"),i=n("sB3e"),o=n("QRG4"),a=n("oeOm");e.exports=function(e,t){var n=1==e,l=2==e,c=3==e,u=4==e,p=6==e,f=5==e||p,d=t||a;return function(t,a,h){for(var v,m,g=i(t),b=r(g),D=s(a,h,3),y=o(b.length),w=0,_=n?d(t,y):l?d(t,0):void 0;y>w;w++)if((f||w in b)&&(m=D(v=b[w],w,g),e))if(n)_[w]=m;else if(m)switch(e){case 3:return!0;case 5:return v;case 6:return w;case 2:_.push(v)}else if(u)return!1;return p?-1:c||u?u:_}}},D2L2:function(e,t){var n={}.hasOwnProperty;e.exports=function(e,t){return n.call(e,t)}},DbPt:function(e,t){},EGZi:function(e,t){e.exports=function(e,t){return{value:t,done:!!e}}},EqjI:function(e,t){e.exports=function(e){return"object"==typeof e?null!==e:"function"==typeof e}},FeBl:function(e,t){var n=e.exports={version:"2.6.9"};"number"==typeof __e&&(__e=n)},Fieg:function(e,t){},HIpB:function(e,t){},HpRW:function(e,t,n){"use strict";var s=n("kM2E"),r=n("lOnJ"),i=n("+ZMJ"),o=n("NWt+");e.exports=function(e){s(s.S,e,{from:function(e){var t,n,s,a,l=arguments[1];return r(this),(t=void 0!==l)&&r(l),void 0==e?new this:(n=[],t?(s=0,a=i(l,arguments[2],2),o(e,!1,function(e){n.push(a(e,s++))})):o(e,!1,n.push,n),new this(n))}})}},Ibhu:function(e,t,n){var s=n("D2L2"),r=n("TcQ7"),i=n("vFc/")(!1),o=n("ax3d")("IE_PROTO");e.exports=function(e,t){var n,a=r(e),l=0,c=[];for(n in a)n!=o&&s(a,n)&&c.push(n);for(;t.length>l;)s(a,n=t[l++])&&(~i(c,n)||c.push(n));return c}},KeD9:function(e,t){},LIJb:function(e,t,n){var s=n("EqjI");e.exports=function(e,t){if(!s(e)||e._t!==t)throw TypeError("Incompatible receiver, "+t+" required!");return e}},M6a0:function(e,t){},MU5D:function(e,t,n){var s=n("R9M2");e.exports=Object("z").propertyIsEnumerable(0)?Object:function(e){return"String"==s(e)?e.split(""):Object(e)}},Mhyx:function(e,t,n){var s=n("/bQp"),r=n("dSzd")("iterator"),i=Array.prototype;e.exports=function(e){return void 0!==e&&(s.Array===e||i[r]===e)}},MmMw:function(e,t,n){var s=n("EqjI");e.exports=function(e,t){if(!s(e))return e;var n,r;if(t&&"function"==typeof(n=e.toString)&&!s(r=n.call(e)))return r;if("function"==typeof(n=e.valueOf)&&!s(r=n.call(e)))return r;if(!t&&"function"==typeof(n=e.toString)&&!s(r=n.call(e)))return r;throw TypeError("Can't convert object to primitive value")}},"NWt+":function(e,t,n){var s=n("+ZMJ"),r=n("msXi"),i=n("Mhyx"),o=n("77Pl"),a=n("QRG4"),l=n("3fs2"),c={},u={};(t=e.exports=function(e,t,n,p,f){var d,h,v,m,g=f?function(){return e}:l(e),b=s(n,p,t?2:1),D=0;if("function"!=typeof g)throw TypeError(e+" is not iterable!");if(i(g)){for(d=a(e.length);d>D;D++)if((m=t?b(o(h=e[D])[0],h[1]):b(e[D]))===c||m===u)return m}else for(v=g.call(e);!(h=v.next()).done;)if((m=r(v,b,h.value,t))===c||m===u)return m}).BREAK=c,t.RETURN=u},O4g8:function(e,t){e.exports=!0},ON07:function(e,t,n){var s=n("EqjI"),r=n("7KvD").document,i=s(r)&&s(r.createElement);e.exports=function(e){return i?r.createElement(e):{}}},PY1w:function(e,t){},PzxK:function(e,t,n){var s=n("D2L2"),r=n("sB3e"),i=n("ax3d")("IE_PROTO"),o=Object.prototype;e.exports=Object.getPrototypeOf||function(e){return e=r(e),s(e,i)?e[i]:"function"==typeof e.constructor&&e instanceof e.constructor?e.constructor.prototype:e instanceof Object?o:null}},QRG4:function(e,t,n){var s=n("UuGF"),r=Math.min;e.exports=function(e){return e>0?r(s(e),9007199254740991):0}},R9M2:function(e,t){var n={}.toString;e.exports=function(e){return n.call(e).slice(8,-1)}},RPLV:function(e,t,n){var s=n("7KvD").document;e.exports=s&&s.documentElement},"RY/4":function(e,t,n){var s=n("R9M2"),r=n("dSzd")("toStringTag"),i="Arguments"==s(function(){return arguments}());e.exports=function(e){var t,n,o;return void 0===e?"Undefined":null===e?"Null":"string"==typeof(n=function(e,t){try{return e[t]}catch(e){}}(t=Object(e),r))?n:i?s(t):"Object"==(o=s(t))&&"function"==typeof t.callee?"Arguments":o}},S82l:function(e,t){e.exports=function(e){try{return!!e()}catch(e){return!0}}},SfB7:function(e,t,n){e.exports=!n("+E39")&&!n("S82l")(function(){return 7!=Object.defineProperty(n("ON07")("div"),"a",{get:function(){return 7}}).a})},TcQ7:function(e,t,n){var s=n("MU5D"),r=n("52gC");e.exports=function(e){return s(r(e))}},TfPY:function(e,t){},UuGF:function(e,t){var n=Math.ceil,s=Math.floor;e.exports=function(e){return isNaN(e=+e)?0:(e>0?s:n)(e)}},UvrK:function(e,t,n){var s=n("kM2E");s(s.P+s.R,"Map",{toJSON:n("m9gC")("Map")})},Vmlu:function(e,t){},X8DO:function(e,t){e.exports=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}}},Xjd4:function(e,t,n){n("9Bbf")("Map")},Yobk:function(e,t,n){var s=n("77Pl"),r=n("qio6"),i=n("xnc9"),o=n("ax3d")("IE_PROTO"),a=function(){},l=function(){var e,t=n("ON07")("iframe"),s=i.length;for(t.style.display="none",n("RPLV").appendChild(t),t.src="javascript:",(e=t.contentWindow.document).open(),e.write("<script>document.F=Object<\/script>"),e.close(),l=e.F;s--;)delete l.prototype[i[s]];return l()};e.exports=Object.create||function(e,t){var n;return null!==e?(a.prototype=s(e),n=new a,a.prototype=null,n[o]=e):n=l(),void 0===t?n:r(n,t)}},ZONA:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=n("ifoU"),r=n.n(s),i=n("mvHQ"),o=n.n(i),a={name:"StartNode",props:{processDesign:Object},computed:{label:{get:function(){return this.processDesign.label.length>4?this.processDesign.label.substring(0,4)+"...":this.processDesign.label}},length:{get:function(){return this.processDesign.label.length>4?5:4}}},methods:{nodeMouseDown:function(e){this.$emit("mousedown",e)}}},l={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("g",{on:{mousedown:function(t){return t.stopPropagation(),e.nodeMouseDown(t)}}},[n("ellipse",{class:{selected:e.processDesign.selected},attrs:{cx:e.processDesign.x,cy:e.processDesign.y,rx:"40",ry:"20"}}),e._v(" "),n("text",{class:{selected:e.processDesign.selected},attrs:{x:e.processDesign.x-6*e.length,y:e.processDesign.y+3}},[e._v("\n    "+e._s(e.label)+"\n  ")])])},staticRenderFns:[]};var c=n("VU/8")(a,l,!1,function(e){n("Vmlu")},"data-v-0b7a6570",null).exports,u={name:"EndNode",props:{processDesign:Object},computed:{label:{get:function(){return this.processDesign.label.length>4?this.processDesign.label.substring(0,4)+"...":this.processDesign.label}},length:{get:function(){return this.processDesign.label.length>4?5:4}}},methods:{nodeMouseDown:function(e){this.$emit("mousedown",e)}}},p={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("g",{on:{mousedown:function(t){return t.stopPropagation(),e.nodeMouseDown(t)}}},[n("ellipse",{class:{selected:e.processDesign.selected},attrs:{cx:e.processDesign.x,cy:e.processDesign.y,rx:"40",ry:"20"}}),e._v(" "),n("text",{class:{selected:e.processDesign.selected},attrs:{x:e.processDesign.x-6*e.length,y:e.processDesign.y+3}},[e._v("\n    "+e._s(e.label)+"\n  ")])])},staticRenderFns:[]};var f=n("VU/8")(u,p,!1,function(e){n("sLJk")},"data-v-54831220",null).exports,d={name:"ApprovalNode",props:{processDesign:Object},computed:{label:{get:function(){return this.processDesign.label.length>4?this.processDesign.label.substring(0,4)+"...":this.processDesign.label}},length:{get:function(){return this.processDesign.label.length>4?5:4}}},methods:{nodeMouseDown:function(e){this.$emit("mousedown",e)}}},h={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("g",{on:{mousedown:function(t){return t.stopPropagation(),e.nodeMouseDown(t)}}},[n("rect",{class:{selected:e.processDesign.selected},attrs:{width:"80",height:"40",x:e.processDesign.x-40,y:e.processDesign.y-20,rx:"5",ry:"5"}}),e._v(" "),n("text",{class:{selected:e.processDesign.selected},attrs:{x:e.processDesign.x-6*e.length,y:e.processDesign.y+3}},[e._v(e._s(e.label)+"\n  ")])])},staticRenderFns:[]};var v=n("VU/8")(d,h,!1,function(e){n("HIpB")},"data-v-18c594f3",null).exports,m={name:"ExclusiveNode",data:function(){return{width:100,height:60}},props:{value:Object,default:function(){return{type:"exclusive",x:0,y:0,label:"审批节点",selected:!1}}},computed:{point:function(){return this.value.x-40+","+this.value.y+" "+(this.value.x+","+(this.value.y-20))+" "+(this.value.x+40+","+this.value.y)+" "+(this.value.x+","+(this.value.y+20))}},methods:{nodeMouseDown:function(e){this.$emit("mousedown",e)}}},g={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("g",{on:{mousedown:function(t){return t.stopPropagation(),e.nodeMouseDown(t)}}},[n("polygon",{class:{selected:e.value.selected},attrs:{points:e.point}}),e._v(" "),n("text",{class:{selected:e.value.selected},attrs:{x:e.value.x-6*e.value.label.length,y:e.value.y+3}},[e._v("\n    "+e._s(e.value.label)+"\n  ")])])},staticRenderFns:[]};var b=n("VU/8")(m,g,!1,function(e){n("KeD9")},"data-v-439ea52c",null).exports,D={name:"TaskNode",props:{value:Object,default:function(){return{type:"task",x:0,y:0,label:"任务节点",selected:!1}}},methods:{nodeMouseDown:function(e){this.$emit("mousedown",e)}}},y={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("g",{on:{mousedown:function(t){return t.stopPropagation(),e.nodeMouseDown(t)}}},[n("circle",{class:{selected:e.value.selected},attrs:{cx:e.value.x,cy:e.value.y,r:"30"}}),e._v(" "),n("text",{class:{selected:e.value.selected},attrs:{x:e.value.x-6*e.value.label.length,y:e.value.y+3}},[e._v(e._s(e.value.label))])])},staticRenderFns:[]};var w=n("VU/8")(D,y,!1,function(e){n("8j1d")},"data-v-9f2f1eb2",null).exports,_={name:"LinkLine",data:function(){return{labelX:0,labelY:0,path:"",endPath:"",endRotate:"",params:{type:0}}},props:{processDesign:Object},watch:{processDesign:{handler:function(e,t){this.parseData()},deep:!0}},mounted:function(){this.parseData()},computed:{label:{get:function(){return this.processDesign.label.length>8?this.processDesign.label.substring(0,8)+"...":this.processDesign.label}}},methods:{parseData:function(){var e=this;setTimeout(function(){e.params=e.processDesign.params?JSON.parse(e.processDesign.params):{type:0,resultType:1,mergeType:"and",fieldList:[]};var t=e.getSourcePoint(),n=e.getTargetPoint(),s=Math.atan2(n[1]-t[1],n[0]-t[0])*(180/Math.PI);e.labelX=(t[0]+n[0])/2,e.labelY=(t[1]+n[1])/2,s<45&&s>=-45?(e.path="M"+t[0]+" "+t[1]+" L"+e.labelX+" "+t[1]+" L"+e.labelX+" "+n[1]+" L"+n[0]+" "+n[1],e.endRotate="rotate(0,"+n[0]+" "+n[1]+")"):-45>s&&s>=-135?(e.path="M"+t[0]+" "+t[1]+" L"+t[0]+" "+e.labelY+" L"+n[0]+" "+e.labelY+" L"+n[0]+" "+n[1],e.endRotate="rotate(-90,"+n[0]+" "+n[1]+")"):135<=s||s<-135?(e.path="M"+t[0]+" "+t[1]+" L"+e.labelX+" "+t[1]+" L"+e.labelX+" "+n[1]+" L"+n[0]+" "+n[1],e.endRotate="rotate(-180,"+n[0]+" "+n[1]+")"):s<135&&s>=45&&(e.path="M"+t[0]+" "+t[1]+" L"+t[0]+" "+e.labelY+" L"+n[0]+" "+e.labelY+" L"+n[0]+" "+n[1],e.endRotate="rotate(90,"+n[0]+" "+n[1]+")"),e.endPath="M"+(n[0]-10)+" "+(n[1]-6)+" L"+(n[0]-10)+" "+(n[1]+6)+" L"+n[0]+" "+n[1]},10)},getTargetPoint:function(){var e=this.processDesign.target;if("temp"==e.type)return[e.x,e.y];var t=this.processDesign.source;return this.getPoint(e.x,e.y,80,40,t.x,t.y)},getSourcePoint:function(){var e=this.processDesign.target,t=this.processDesign.source;return this.getPoint(t.x,t.y,80,40,e.x,e.y)},getPoint:function(e,t,n,s,r,i){var o=[e,t-s/2],a=Math.sqrt(Math.pow(e-r,2)+Math.pow(t-s/2-i,2)),l=Math.sqrt(Math.pow(e+n/2-r,2)+Math.pow(t-i,2));return l<a&&(a=l,o=[e+n/2,t]),(l=Math.sqrt(Math.pow(e-r,2)+Math.pow(t+s/2-i,2)))<a&&(a=l,o=[e,t+s/2]),(l=Math.sqrt(Math.pow(e-n/2-r,2)+Math.pow(t-i,2)))<a&&(a=l,o=[e-n/2,t]),o},nodeMouseDown:function(e){this.$emit("mousedown",e)}}},x={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("g",{on:{mousedown:function(t){return t.stopPropagation(),e.nodeMouseDown(t)}}},[n("path",{staticClass:"line-path",class:{selected:e.processDesign.selected},attrs:{d:e.path}}),e._v(" "),n("text",{class:{selected:e.processDesign.selected},attrs:{x:e.labelX,y:e.labelY}},[e._v("\n    "+e._s(e.label)+"\n  ")]),e._v(" "),n("path",{staticClass:"arrow-path",class:{selected:e.processDesign.selected},attrs:{d:e.endPath,transform:e.endRotate}})])},staticRenderFns:[]};var k=n("VU/8")(_,x,!1,function(e){n("g2ym")},"data-v-dc2a0852",null).exports,M={name:"StartNode",props:{processDesign:Object,default:function(){return{type:"start",x:0,y:0,label:"抄送节点",selected:!1}}},methods:{nodeMouseDown:function(e){this.$emit("mousedown",e)}}},O={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("g",{on:{mousedown:function(t){return t.stopPropagation(),e.nodeMouseDown(t)}}},[n("rect",{class:{selected:e.processDesign.selected},attrs:{width:"80",height:"40",x:e.processDesign.x-40,y:e.processDesign.y-20,rx:"5",ry:"5"}}),e._v(" "),n("text",{class:{selected:e.processDesign.selected},attrs:{x:e.processDesign.x-6*e.processDesign.label.length,y:e.processDesign.y+3}},[e._v(e._s(e.processDesign.label))])])},staticRenderFns:[]};var F=n("VU/8")(M,O,!1,function(e){n("zffa")},"data-v-445192ec",null).exports,I={name:"StartNode",props:{value:Object,default:function(){return{type:"child",x:0,y:0,label:"子流程",selected:!1,params:""}}},methods:{nodeMouseDown:function(e){this.$emit("mousedown",e)},toChild:function(){if(this.value.params){var e=JSON.parse(this.value.params);e&&e.flowId&&this.$emit("to-child",e.flowId)}}}},S={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("g",{on:{mousedown:function(t){return t.stopPropagation(),e.nodeMouseDown(t)},dblclick:function(t){return t.stopPropagation(),e.toChild(t)}}},[n("rect",{class:{selected:e.value.selected},attrs:{width:"80",height:"40",x:e.value.x-40,y:e.value.y-20,rx:"5",ry:"5"}}),e._v(" "),n("text",{class:{selected:e.value.selected},attrs:{x:e.value.x-6*e.value.label.length,y:e.value.y+3}},[e._v(e._s(e.value.label))])])},staticRenderFns:[]};var L={name:"FlowDesignComponent",components:{start:c,end:f,approval:v,exclusive:b,task:w,linkLine:k,copy:F,child:n("VU/8")(I,S,!1,function(e){n("PY1w")},"data-v-3cb3007c",null).exports},props:{flowDesign:{type:Object},width:{type:Number,default:0},height:{type:Number,default:0}},data:function(){return{scale:1,Origin:"0 0",left:0,top:0,selected:{},mode:"point",oldX:0,oldY:0}},watch:{width:{handler:function(e,t){this.parseScale()}},height:{handler:function(e,t){this.parseScale()}}},mounted:function(){var e=this;this.parseScale(),window.onresize=function(){e.parseScale()}},methods:{parseScale:function(){var e=this.$el.getBoundingClientRect(),t=0,n=0;(this.width>0||this.height>0)&&(this.width>0&&(t=e.width/this.width),this.height>0&&(n=e.height/this.height)),this.scale=t>0&&n>0?n<t?n:t:n>0&&0==t?n:0==n&&t>0?t:1},changeSelected:function(e){this.selected.label=e.label,this.selected.params=e.params},deleteSelected:function(){if(this.selected)for(var e=this.flowDesign.processDesigns.length-1;e>=0;e--){var t=this.flowDesign.processDesigns[e];t!=this.selected?"linkLine"!=t.type||t.target!=this.selected&&t.source!=this.selected||this.flowDesign.processDesigns.splice(e,1):this.flowDesign.processDesigns.splice(e,1)}},addNodeNode:function(e,t){if("start"==e||"end"==e)for(var n=0;n<this.flowDesign.processDesigns.length;n++)if(this.flowDesign.processDesigns[n].type==e)return void this.$Message.warning("该类型节点只能有一个");var s=this.$el.getBoundingClientRect(),r=(event.clientX-s.left-this.left)/this.scale,i=(event.clientY-s.top-this.top)/this.scale;this.unSelect();var a={sid:this.flowDesign.processDesigns.length,x:r,y:i,type:e,label:t,selected:!0,params:""};"approval"===e&&(a.userList=[],a.roleList=[],a.params=o()({title:"",description:"",department:"",user:"",role:"",mode:2})),this.flowDesign.processDesigns.push(a)},addLine:function(){console.info("开始连线"),this.unSelect(),this.selected=null,this.mode="line"},unSelect:function(){this.flowDesign.processDesigns.forEach(function(e){e.selected=!1})},scrollBarWheel:function(e){var t=e.deltaY||e.detail;this.scale=t>0?this.scale-.01*this.scale:this.scale+.01*this.scale},svgMouseDown:function(e){this.unSelect(),this.selected&&"line"==this.mode&&this.flowDesign.processDesigns.splice(this.lineList.length-1,1),this.mode="svg",this.oldX=e.clientX,this.oldY=e.clientY,this.$emit("selected",null)},nodeMouseDown:function(e,t){if(this.unSelect(),this.oldX=e.clientX,this.oldY=e.clientY,"line"==this.mode){var n=this.$el.getBoundingClientRect();if(this.selected)console.info("连线结束"),this.selected.target=this.flowDesign.processDesigns[t],this.mode="point";else{var s=(e.clientX-n.left-this.left)/this.scale,r=(e.clientY-n.top-this.top)/this.scale;this.selected={sid:this.flowDesign.processDesigns.length,type:"linkLine",label:"",selected:!0,source:this.flowDesign.processDesigns[t],target:{id:"",x:s,y:r,type:"temp"},params:""},this.flowDesign.processDesigns.push(this.selected)}}else"point"==this.mode&&(this.selected=this.flowDesign.processDesigns[t],this.selected.selected=!0,this.mode="drag");this.$emit("selected",this.selected)},lineMouseDown:function(e,t){this.unSelect(),this.selected=this.flowDesign.processDesigns[t],this.selected.selected=!0,this.$emit("selected",this.selected)},mouseMove:function(e){var t=this.$el.getBoundingClientRect();if("drag"==this.mode){if(this.selected){var n=(e.clientX-this.oldX)/this.scale,s=(e.clientY-this.oldY)/this.scale;this.selected.x+=n,this.selected.y+=s,this.selected.x=this.selected.x<0?0:this.selected.x>2e3?2e3:this.selected.x,this.selected.y=this.selected.y<0?0:this.selected.y>2e3?2e3:this.selected.y,this.oldX=e.clientX,this.oldY=e.clientY}}else if("svg"==this.mode){var r=e.clientX-this.oldX,i=e.clientY-this.oldY;this.oldX=e.clientX,this.oldY=e.clientY,this.left+=r,this.top+=i}else if("line"==this.mode&&this.selected){var o=(e.clientX-t.left-this.left)/this.scale,a=(e.clientY-t.top-this.top)/this.scale;this.selected.target.x=o-3,this.selected.target.y=a-3}},mouseUp:function(e){"point"===this.mode||("svg"==this.mode?(this.mode="point",this.selected=null):"drag"===this.mode&&(this.mode="point"))}}},C={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"flow-design-nodes",attrs:{id:"flow_design_svg"},on:{mousemove:function(t){return e.mouseMove(t)},mouseup:function(t){return e.mouseUp(t)}}},[n("svg",{attrs:{width:"2000",height:"2000",version:"1.1",xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink"},on:{DOMMouseScroll:function(t){return e.scrollBarWheel(t)},"&mousewheel":function(t){return e.scrollBarWheel(t)},mousedown:function(t){return e.svgMouseDown(t)}}},[n("defs",[n("marker",{attrs:{id:"arrow",markerWidth:"10",markerHeight:"10",refx:"0",refy:"3",orient:"auto",markerUnits:"strokeWidth"}},[n("path",{attrs:{d:"M0,0 L0,6 L9,3 z",fill:"#f00"}})])]),e._v(" "),n("g",{attrs:{transform:"translate("+e.left+" "+e.top+") scale("+e.scale+" "+e.scale+")"}},[e._l(e.flowDesign.processDesigns,function(t,s){return[n(t.type,{tag:"component",attrs:{processDesign:t,base:e.flowDesign},on:{mousedown:function(t){return e.nodeMouseDown(t,s)}}})]})],2)])])},staticRenderFns:[]};var E=n("VU/8")(L,C,!1,function(e){n("7OT6")},"data-v-814ed826",null).exports,$={name:"ApprovalInput",data:function(){return{isFirst:!0,params:{userList:[],roleList:[]}}},props:{processDesign:{type:Object},base:{type:Object,default:function(){return{}}}},watch:{processDesign:{handler:function(e,t){this.initParams()},deep:!0},params:{handler:function(e,t){this.processDesign.params=o()(this.params)},deep:!0}},methods:{handleAddUser:function(e){var t=e.target.value;""!==t&&(-1===this.processDesign.userList.indexOf(t)?(this.processDesign.userList.push(t),e.target.value=""):this.$Message.error("该用户已经存在了！"))},handleAddRole:function(e){var t=e.target.value;""!==t&&(-1===this.processDesign.roleList.indexOf(t)?(this.processDesign.roleList.push(t),e.target.value=""):this.$Message.error("该角色已经存在了！"))},handleRemoveUser:function(e){this.processDesign.userList.splice(this.processDesign.userList.indexOf(e,1))},handleRemoveRole:function(e){this.processDesign.roleList.splice(this.processDesign.roleList.indexOf(e,1))},initParams:function(){this.isFirst=!0,this.params=this.processDesign.params?JSON.parse(this.processDesign.params):{userList:[],roleList:[]}}},created:function(){this.initParams()}},j={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("Form",{attrs:{model:e.processDesign,"label-width":60}},[n("FormItem",{staticClass:"input-item",attrs:{label:"类型"}},[n("Input",{attrs:{value:"审批节点",placeholder:"",disabled:""}})],1),e._v(" "),n("FormItem",{staticClass:"input-item",attrs:{label:"显示名"}},[n("Input",{attrs:{placeholder:""},model:{value:e.processDesign.label,callback:function(t){e.$set(e.processDesign,"label",t)},expression:"processDesign.label"}})],1),e._v(" "),n("FormItem",{staticClass:"input-item",attrs:{label:"描述"}},[n("Input",{attrs:{placeholder:"",type:"textarea",rows:5},model:{value:e.params.description,callback:function(t){e.$set(e.params,"description",t)},expression:"params.description"}})],1),e._v(" "),n("FormItem",{staticClass:"input-item",attrs:{label:"审批类型"}},[n("Select",{model:{value:e.params.mode,callback:function(t){e.$set(e.params,"mode",t)},expression:"params.mode"}},[n("Option",{attrs:{value:2}},[e._v("或签")]),e._v(" "),n("Option",{attrs:{value:1}},[e._v("会签")])],1)],1),e._v(" "),n("FormItem",{staticClass:"input-item",attrs:{label:"部门"}},[n("Input",{attrs:{placeholder:""},model:{value:e.params.department,callback:function(t){e.$set(e.params,"department",t)},expression:"params.department"}})],1),e._v(" "),n("FormItem",{staticClass:"input-item",attrs:{label:"审核用户"}},[n("Input",{attrs:{placeholder:"输入完毕按回车添加"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.handleAddUser(t)}}}),e._v(" "),n("div",e._l(e.processDesign.userList,function(t){return n("tag",{key:t,attrs:{closable:"",color:"blue",type:"border"},on:{"on-close":e.handleRemoveUser}},[e._v("\n        "+e._s(t)+"\n      ")])}),1)],1),e._v(" "),n("FormItem",{staticClass:"input-item",attrs:{label:"审核角色"}},[n("Input",{attrs:{placeholder:"输入完毕按回车添加"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.handleAddRole(t)}}}),e._v(" "),n("div",e._l(e.processDesign.roleList,function(t){return n("tag",{key:t,attrs:{closable:"",color:"blue",type:"border"},on:{"on-close":e.handleRemoveRole}},[e._v("\n        "+e._s(t)+"\n      ")])}),1)],1)],1)},staticRenderFns:[]};var T=n("VU/8")($,j,!1,function(e){n("sfEQ")},"data-v-7d4cdc8c",null).exports,R={name:"StartInput",data:function(){return{form:{}}},props:{processDesign:{type:Object},base:{type:Object,default:function(){return{}}}},methods:{},mounted:function(){this.form=this.value}},P={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("Form",{attrs:{model:e.processDesign,"label-width":50}},[n("FormItem",{staticClass:"input-item",attrs:{label:"类型"}},[n("Input",{attrs:{value:"结束节点",placeholder:"",disabled:""}})],1),e._v(" "),n("FormItem",{staticClass:"input-item",attrs:{label:"显示名"}},[n("Input",{attrs:{placeholder:""},model:{value:e.processDesign.label,callback:function(t){e.$set(e.processDesign,"label",t)},expression:"processDesign.label"}})],1)],1)},staticRenderFns:[]};var N=n("VU/8")(R,P,!1,function(e){n("ZZXr")},"data-v-1bf8df4f",null).exports,U={name:"TagInput",data:function(){return{inputTag:""}},props:{value:{type:Array,default:function(){return[]}}},methods:{removeTag:function(e){this.value.splice(e,1)},inputComplete:function(){if(this.inputTag){if(!/[a-zA-Z\u4e00-\u9fa5]\S*/.test(this.inputTag))return void this.$Message.warning("字段名称只能是中文或者字母开头");for(var e=this.value.length,t=0;t<e;t++)if(this.value[t]==this.inputTag)return void this.$Message.warning("字段已经存在在字段列表中");this.value.push(this.inputTag),this.inputTag=""}}}},B={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("Input",{attrs:{placeholder:""},on:{"on-enter":e.inputComplete},model:{value:e.inputTag,callback:function(t){e.inputTag=t},expression:"inputTag"}}),e._v(" "),n("ul",{staticClass:"tag-input"},e._l(e.value,function(t,s){return n("li",{key:s},[n("span",[e._v(e._s(t))]),e._v(" "),n("Icon",{attrs:{type:"ios-close",size:"14"},on:{click:function(t){return e.removeTag(s)}}})],1)}),0)],1)},staticRenderFns:[]};var A={name:"ExclusiveInput",components:{TagInput:n("VU/8")(U,B,!1,function(e){n("0tT4")},"data-v-d449069a",null).exports},data:function(){return{form:{},fieldList:[],selectFields:[],selectIndex:-1}},props:{value:{type:Object,default:function(){return{label:"",params:{fields:[]}}}},base:{type:Object,default:function(){return{}}}},watch:{value:{handler:function(e,t){this.parseData()},deep:!0},form:{handler:function(e,t){this.$emit("input",this.form)},deep:!0},selectFields:{handler:function(e,t){this.form.params=o()(e)},deep:!0}},methods:{parseData:function(){var e=this;setTimeout(function(){e.form=e.value,e.selectFields=e.value.params?JSON.parse(e.value.params):[]},200)},initList:function(){var e=this;this.$http.get(this.$api.finance.setting.getReimbusementTypeFieldList,{params:{typeCode:this.base.type}}).then(function(t){var n=t.data;!0===n.success?e.fieldList=n.data:e.$Message.warning(n.prompt)}).catch(function(t){e.$log(t,4)})}},mounted:function(){this.parseData()}},J={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("Form",{attrs:{model:e.form,"label-width":50}},[n("FormItem",{staticClass:"input-item",attrs:{label:"类型"}},[n("Input",{attrs:{value:"排他节点",placeholder:"",disabled:""}})],1),e._v(" "),n("FormItem",{staticClass:"input-item",attrs:{label:"显示名"}},[n("Input",{attrs:{placeholder:""},model:{value:e.form.label,callback:function(t){e.$set(e.form,"label",t)},expression:"form.label"}})],1),e._v(" "),n("FormItem",{staticClass:"input-item",attrs:{label:"字段"}},[n("tag-input",{model:{value:e.selectFields,callback:function(t){e.selectFields=t},expression:"selectFields"}})],1)],1)},staticRenderFns:[]};var Y=n("VU/8")(A,J,!1,function(e){n("Fieg")},"data-v-b5e399ea",null).exports,V={name:"StartInput",data:function(){return{form:{}}},props:{processDesign:{type:Object}}},X={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("Form",{attrs:{model:e.processDesign,"label-width":50}},[n("FormItem",{staticClass:"input-item",attrs:{label:"类型"}},[n("Input",{attrs:{value:"开始节点",placeholder:"",disabled:""}})],1),e._v(" "),n("FormItem",{staticClass:"input-item",attrs:{label:"显示名"}},[n("Input",{attrs:{placeholder:""},model:{value:e.processDesign.label,callback:function(t){e.$set(e.processDesign,"label",t)},expression:"processDesign.label"}})],1)],1)},staticRenderFns:[]};var q=n("VU/8")(V,X,!1,function(e){n("qMYg")},"data-v-28b16c7d",null).exports,z={name:"StartInput",data:function(){return{form:{},params:{taskName:""}}},props:{value:{type:Object,default:function(){return{label:"",params:""}}},base:{type:Object,default:function(){return{}}}},watch:{value:{handler:function(e,t){this.form=this.value,this.parseData()},deep:!0},form:{handler:function(e,t){this.$emit("input",this.form)},deep:!0},params:{handler:function(e,t){this.form.params=o()(this.params)},deep:!0}},methods:{parseData:function(){var e=this;setTimeout(function(){if(e.form=e.value,e.form.params){var t=JSON.parse(e.value.params);e.params=t}else e.params={taskName:""}},200)}},mounted:function(){this.parseData()}},K={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("Form",{attrs:{model:e.form,"label-width":50}},[n("FormItem",{staticClass:"input-item",attrs:{label:"类型"}},[n("Input",{attrs:{value:"任务节点",placeholder:"",disabled:""}})],1),e._v(" "),n("FormItem",{staticClass:"input-item",attrs:{label:"显示名"}},[n("Input",{attrs:{placeholder:""},model:{value:e.form.label,callback:function(t){e.$set(e.form,"label",t)},expression:"form.label"}})],1),e._v(" "),n("FormItem",{staticClass:"input-item",attrs:{label:"任务名"}},[n("Input",{attrs:{placeholder:""},model:{value:e.params.taskName,callback:function(t){e.$set(e.params,"taskName",t)},expression:"params.taskName"}})],1)],1)},staticRenderFns:[]};var W=n("VU/8")(z,K,!1,function(e){n("5lMD")},"data-v-950cf31c",null).exports,G={name:"LineInput",data:function(){return{}},props:{processDesign:{type:Object},base:{type:Object,default:function(){return{}}}}},Q={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("Form",{attrs:{model:e.processDesign,"label-width":60}},[n("FormItem",{staticClass:"input-item",attrs:{label:"类型"}},[n("Input",{attrs:{value:"连线",placeholder:"",disabled:""}})],1),e._v(" "),n("FormItem",{staticClass:"input-item",attrs:{label:"显示名"}},[n("Input",{attrs:{placeholder:""},model:{value:e.processDesign.label,callback:function(t){e.$set(e.processDesign,"label",t)},expression:"processDesign.label"}})],1),e._v(" "),"start"!==e.processDesign.source.type&&"end"!==e.processDesign.target.type?n("div",[n("FormItem",{staticClass:"input-item",attrs:{label:"字段"}},[n("Input",{staticStyle:{width:"100%"},attrs:{placeholder:""},model:{value:e.processDesign.field,callback:function(t){e.$set(e.processDesign,"field",t)},expression:"processDesign.field"}})],1),e._v(" "),n("FormItem",{staticClass:"input-item",attrs:{label:"条件"}},[n("Select",{staticClass:"term",staticStyle:{width:"100%"},model:{value:e.processDesign.condition,callback:function(t){e.$set(e.processDesign,"condition",t)},expression:"processDesign.condition"}},[n("Option",{attrs:{value:"=="}},[e._v("等于")]),e._v(" "),n("Option",{attrs:{value:"!="}},[e._v("不等于")]),e._v(" "),n("Option",{attrs:{value:"like"}},[e._v("包含")]),e._v(" "),n("Option",{attrs:{value:"not_like"}},[e._v("不包含")]),e._v(" "),n("Option",{attrs:{value:">"}},[e._v("大于")]),e._v(" "),n("Option",{attrs:{value:">="}},[e._v("大于等于")]),e._v(" "),n("Option",{attrs:{value:"<"}},[e._v("小于")]),e._v(" "),n("Option",{attrs:{value:"<="}},[e._v("小于等于")])],1)],1),e._v(" "),n("FormItem",{staticClass:"input-item",attrs:{label:"条件值"}},[n("Input",{staticStyle:{width:"100%"},attrs:{placeholder:""},model:{value:e.processDesign.value,callback:function(t){e.$set(e.processDesign,"value",t)},expression:"processDesign.value"}})],1)],1):e._e()],1)},staticRenderFns:[]};var H=n("VU/8")(G,Q,!1,function(e){n("54na")},"data-v-5e5a5cc6",null).exports,Z={name:"BaseInput",data:function(){return{form:{}}},props:{flowDesign:{type:Object}},methods:{handleAddUser:function(e){var t=e.target.value;""!==t&&(-1===this.flowDesign.userList.indexOf(t)?(this.flowDesign.userList.push(t),e.target.value=""):this.$Message.error("该用户已经存在了！"))},handleRemoveUser:function(e){this.flowDesign.userList.splice(this.flowDesign.userList.indexOf(e,1))}}},ee={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("Form",{attrs:{model:e.flowDesign,"label-width":80}},[n("FormItem",{staticClass:"input-item",attrs:{label:"名称"}},[n("Input",{attrs:{placeholder:""},model:{value:e.flowDesign.title,callback:function(t){e.$set(e.flowDesign,"title",t)},expression:"flowDesign.title"}})],1),e._v(" "),n("FormItem",{staticClass:"input-item",attrs:{label:"失败模式"}},[n("Select",{model:{value:e.flowDesign.backMode,callback:function(t){e.$set(e.flowDesign,"backMode",t)},expression:"flowDesign.backMode"}},[n("Option",{attrs:{value:1}},[e._v("整体失败")]),e._v(" "),n("Option",{attrs:{value:2}},[e._v("退回上一步")])],1)],1),e._v(" "),n("FormItem",{staticClass:"input-item",attrs:{label:"描述"}},[n("Input",{attrs:{type:"textarea",rows:5,placeholder:""},model:{value:e.flowDesign.description,callback:function(t){e.$set(e.flowDesign,"description",t)},expression:"flowDesign.description"}})],1),e._v(" "),n("FormItem",{staticClass:"input-item",attrs:{label:"结果抄送人"}},[n("Input",{attrs:{placeholder:"输入完毕按回车添加"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.handleAddUser(t)}}}),e._v(" "),n("div",e._l(e.flowDesign.userList,function(t){return n("tag",{key:t,attrs:{closable:"",color:"blue",type:"border"},on:{"on-close":e.handleRemoveUser}},[e._v("\n        "+e._s(t)+"\n      ")])}),1)],1)],1)},staticRenderFns:[]};var te=n("VU/8")(Z,ee,!1,function(e){n("7I/A")},"data-v-2ef4c0b1",null).exports,ne={name:"CopyInput",data:function(){return{isFirst:!0,form:{},params:[]}},props:{value:{type:Object,default:function(){return{label:"",params:{}}}},base:{type:Object,default:function(){return{}}}},watch:{value:{handler:function(e,t){this.isFirst=!0,this.parseData()},deep:!0},form:{handler:function(e,t){this.$emit("input",this.form)},deep:!0},params:{handler:function(e,t){this.form.params=o()(this.params)},deep:!0}},methods:{parseData:function(){var e=this;setTimeout(function(){if(e.form=e.value,e.form.params){var t=JSON.parse(e.value.params);e.params=t}else e.params=[]},200)}},mounted:function(){this.isFirst=!0,this.parseData()}},se={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("Form",{attrs:{model:e.form,"label-width":60}},[n("FormItem",{staticClass:"input-item",attrs:{label:"类型"}},[n("Input",{attrs:{value:"抄送节点",placeholder:"",disabled:""}})],1),e._v(" "),n("FormItem",{staticClass:"input-item",attrs:{label:"显示名"}},[n("Input",{attrs:{placeholder:""},model:{value:e.form.label,callback:function(t){e.$set(e.form,"label",t)},expression:"form.label"}})],1),e._v(" "),n("FormItem",{staticClass:"input-item",attrs:{label:"抄送人"}})],1)},staticRenderFns:[]};var re=n("VU/8")(ne,se,!1,function(e){n("xgs/")},"data-v-1c40df8a",null).exports,ie={name:"ChildInput",data:function(){return{showInput:!1,isFirst:!0,form:{},addForm:{name:"",failType:"first_step"},list:[],params:{flowId:""}}},props:{value:{type:Object,default:function(){return{label:"",params:{}}}},base:{type:Object,default:function(){return{}}}},watch:{value:{handler:function(e,t){this.isFirst=!0,this.parseData()},deep:!0},form:{handler:function(e,t){this.$emit("input",this.form)},deep:!0},params:{handler:function(e,t){this.form.params=o()(this.params)},deep:!0}},methods:{saveBean:function(){var e=this;if(!this.addForm.name)return this.$Message.warning("请输入正确的名称"),this.$refs.accountBooksWin.visible=!0,void(this.showInput=!0);this.$http.post(this.$api.finance.setting.postFlowDesignPageSaveOrUpdateMsg,this.addForm).then(function(t){var n=t.data;!0===n.success?(e.$Message.info("操作成功"),e.params.flowId=n.data,e.initList()):(e.$refs.accountBooksWin.visible=!0,e.showInput=!0,e.$Message.warning(n.prompt))}).catch(function(t){e.$refs.accountBooksWin.visible=!0,e.showInput=!0,e.$log(t,4)})},addFlowDesign:function(){this.addForm.name="",this.showInput=!0},parseData:function(){var e=this;setTimeout(function(){if(e.form=e.value,e.form.params){var t=JSON.parse(e.value.params);e.params=t}else e.params={flowId:""}},200)}},mounted:function(){this.isFirst=!0,this.parseData()}},oe={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("Form",{attrs:{model:e.form,"label-width":60}},[n("FormItem",{staticClass:"input-item",attrs:{label:"类型"}},[n("Input",{attrs:{value:"子流程节点",placeholder:"",disabled:""}})],1),e._v(" "),n("FormItem",{staticClass:"input-item",attrs:{label:"显示名"}},[n("Input",{attrs:{placeholder:""},model:{value:e.form.label,callback:function(t){e.$set(e.form,"label",t)},expression:"form.label"}})],1),e._v(" "),n("FormItem",{staticClass:"input-item",attrs:{label:"选择流程"}},[n("Select",{model:{value:e.params.flowId,callback:function(t){e.$set(e.params,"flowId",t)},expression:"params.flowId"}},e._l(e.list,function(t){return t.id!=e.base.id?n("Option",{key:t.id,attrs:{value:t.id}},[e._v(e._s(t.name))]):e._e()}),1)],1),e._v(" "),n("FormItem",{staticClass:"input-item",attrs:{label:""}},[n("Button",{on:{click:e.addFlowDesign}},[e._v("添加")])],1)],1),e._v(" "),n("Modal",{ref:"accountBooksWin",attrs:{title:"设计器管理",width:"700"},on:{"on-ok":e.saveBean},model:{value:e.showInput,callback:function(t){e.showInput=t},expression:"showInput"}},[n("Form",{ref:"form",attrs:{model:e.addForm,"label-width":100}},[n("FormItem",{attrs:{label:"设计器名称",prop:"name"}},[n("Input",{attrs:{placeholder:"设计器名称"},model:{value:e.addForm.name,callback:function(t){e.$set(e.addForm,"name",t)},expression:"addForm.name"}})],1),e._v(" "),n("FormItem",{attrs:{label:"失败退回",prop:"failType"}},[n("Select",{model:{value:e.addForm.failType,callback:function(t){e.$set(e.addForm,"failType",t)},expression:"addForm.failType"}},[n("Option",{attrs:{value:"first_step"}},[e._v("退回第一步")]),e._v(" "),n("Option",{attrs:{value:"last_step"}},[e._v("退回上一步")])],1)],1)],1)],1)],1)},staticRenderFns:[]};var ae={name:"FlowDesignInput",components:{start:q,end:N,approval:T,exclusive:Y,task:W,linkLine:H,copy:re,child:n("VU/8")(ie,oe,!1,function(e){n("A5f+")},"data-v-ce2d318e",null).exports,BaseInput:te},props:{processDesign:{type:Object},flowDesign:{type:Object}},watch:{}},le={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"flow-design-input"},[e.processDesign&&e.processDesign.type?[n(e.processDesign.type,{tag:"component",attrs:{processDesign:e.processDesign,base:e.flowDesign}})]:e._e(),e._v(" "),e.processDesign&&e.processDesign.type?e._e():[n("base-input",{attrs:{flowDesign:e.flowDesign}})]],2)},staticRenderFns:[]};var ce=n("VU/8")(ae,le,!1,function(e){n("TfPY")},"data-v-3903f44e",null).exports,ue=n("ymH/"),pe={name:"FlowDesign",data:function(){return{flowTypes:[{type:"start",label:"开始节点"},{type:"approval",label:"审批节点"},{type:"end",label:"结束节点"}],flowDesign:{},spinShow:!1,selectedNode:null}},components:{FlowDesignNodes:E,FlowDesignInput:ce},methods:{nodeDataChange:function(e){this.$refs.flowDesign.changeSelected(e)},nodeSelected:function(e){this.selectedNode=e},getCurrentData:function(){var e=JSON.parse(o()(this.flowDesign));e.processDesigns&&e.processDesigns.forEach(function(e){"linkLine"==e.type&&(e.target=e.target.sid,e.source=e.source.sid)});var t=this.$refs.flowDesign.$el.getBoundingClientRect();return e.width=t.width,e.height=t.height,e},saveDesign:function(){var e=this;this.spinShow=!0;var t=this.getCurrentData(),n=t.processDesigns.map(function(e){return e.type});if(-1===n.indexOf("start")||-1===n.indexOf("end")||-1===n.indexOf("approval"))return this.$Message.error("流程设计不完整，请检查！"),void(this.spinShow=!1);if(this.getArrayEleCount(n,"linkLine",!1)!==this.getArrayEleCount(n,"linkLine",!0)-1)return this.$Message.error("连线有误，请检查！"),void(this.spinShow=!1);var s=new r.a;t.processDesigns.filter(function(e){return"linkLine"!==e.type}).forEach(function(e){return s.set(e.sid,e)});var i=t.processDesigns.filter(function(e){return"linkLine"===e.type&&s.get(e.source)&&"start"===s.get(e.source).type})[0],o=s.get(i.target);this.refactorNode(o,1),this.buildDesign(t,s,o.sid,2),t.receiveUser=t.userList.join(","),delete t.userList,t.sid?Object(ue.f)(t).then(function(t){200===t.data.code?(e.$Message.success("重置成功"),e.doBack()):e.$Message.error(t.data.message?t.data.message:"系统异常"),setTimeout(function(){e.spinShow=!1},200)}).catch(function(t){e.$Message.error(t)}):Object(ue.a)(t).then(function(t){200===t.data.code?(e.$Message.success("保存成功"),e.doBack()):e.$Message.error(t.data.message?t.data.message:"系统异常"),setTimeout(function(){e.spinShow=!1},200)}).catch(function(t){e.$Message.error(t||"系统异常"),setTimeout(function(){e.spinShow=!1},200)})},buildDesign:function(e,t,n,s){var r=e.processDesigns.filter(function(e){return"linkLine"===e.type&&t.get(e.source)&&t.get(e.source).sid===n&&"end"!==t.get(e.target).type&&t.get(e.target)})[0];if(r){var i=JSON.parse(t.get(n).params);i.field=r.field,i.condition=r.condition,i.value=r.value,t.get(n).params=o()(i),delete r.field,delete r.condition,delete r.value;var a=t.get(r.target);this.refactorNode(a,s),this.buildDesign(e,t,a.sid,++s)}},refactorNode:function(e,t){var n=JSON.parse(e.params);n.ordered=t,n.title=e.label,n.user=e.userList.join(","),n.role=e.roleList.join(","),delete e.userList,delete e.roleList,e.params=o()(n)},removeSelected:function(){var e=this;this.$Modal.confirm({title:"提示",content:"<p>您确认删除吗</p>",onOk:function(){e.$refs.flowDesign.deleteSelected(),e.selectedNode=null},onCancel:function(){}})},linkLine:function(){this.$refs.flowDesign.addLine()},allowDrop:function(e){e.preventDefault()},drag:function(e,t){e.dataTransfer.setData("flow_type",t)},drop:function(e){e.preventDefault();for(var t=e.dataTransfer.getData("flow_type"),n="",s=0;s<this.flowTypes.length;s++)if(this.flowTypes[s].type===t){n=this.flowTypes[s].label;break}this.$refs.flowDesign.addNodeNode(t,n)},initData:function(){var e=this,t=this.$route.query.sid;t?Object(ue.b)(t).then(function(t){e.flowDesign=e.parseData(t.data.body)}).catch(function(t){e.$Message.error(t)}):(this.spinShow=!0,this.flowDesign={processDesigns:[],title:"",description:"",backMode:2,sid:null,userList:[]},setTimeout(function(){e.spinShow=!1},200))},doBack:function(){this.$router.push({path:"/flowList"})},parseData:function(e){var t=new r.a;return e.userList=e.receiveUser?e.receiveUser.split(","):[],e.processDesigns.forEach(function(e){if(t.set(e.sid,e),e.selected=!1,"approval"===e.type){var n=JSON.parse(e.params);e.userList=n.user?n.user.split(","):[],e.roleList=n.role?n.role.split(","):[]}if("linkLine"===e.type){var s=t.get(e.source);e.source=s,e.target=t.get(e.target);var r=s.params?JSON.parse(s.params):{};e.field=r.field,e.condition=r.condition,e.value=r.value}else e.x=e.x-0,e.y=e.y-0}),e},getArrayEleCount:function(e,t,n){return e.filter(function(e){return n?e!==t:e===t}).length}},mounted:function(){this.initData()}},fe={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"flow-design"},[n("div",{staticClass:"top-pane"},[n("a",{staticClass:"item",attrs:{href:"javascript:void(0)"},on:{click:e.saveDesign}},[e._v("保存")]),e._v(" "),n("a",{staticClass:"item",attrs:{href:"javascript:void(0)"},on:{click:e.removeSelected}},[e._v("删除")]),e._v(" "),n("a",{staticClass:"item",attrs:{href:"javascript:void(0)"},on:{click:e.linkLine}},[e._v("连线")]),e._v(" "),n("a",{staticClass:"item",attrs:{href:"javascript:void(0)"},on:{click:function(t){return e.initData()}}},[e._v("重新加载")]),e._v(" "),n("a",{staticClass:"item",attrs:{href:"javascript:void(0)"},on:{click:function(t){return e.doBack()}}},[e._v("返回")])]),e._v(" "),n("div",{staticClass:"bottom-pane"},[n("div",{staticClass:"left-menu"},e._l(e.flowTypes,function(t,s){return n("div",{staticClass:"menu-item",attrs:{type:t.type,draggable:"true"},on:{dragstart:function(n){return e.drag(n,t.type)}}},[e._v("\n        "+e._s(t.label)+"\n      ")])}),0),e._v(" "),n("div",{staticClass:"center-content",on:{drop:function(t){return e.drop(t)},dragover:function(t){return e.allowDrop(t)}}},[n("flow-design-nodes",{ref:"flowDesign",attrs:{flowDesign:e.flowDesign,width:e.flowDesign.width,height:e.flowDesign.height,base:e.flowDesign},on:{selected:e.nodeSelected}})],1),e._v(" "),n("div",{staticClass:"right-property"},[n("flow-design-input",{attrs:{processDesign:e.selectedNode,flowDesign:e.flowDesign},on:{"change-node":e.nodeDataChange}})],1)]),e._v(" "),e.spinShow?n("Spin",{attrs:{size:"large",fix:""}},[n("Icon",{staticClass:"demo-spin-icon-load",attrs:{type:"ios-loading",size:"18"}}),e._v(" "),n("div",[e._v("加载中...")])],1):e._e()],1)},staticRenderFns:[]};var de=n("VU/8")(pe,fe,!1,function(e){n("DbPt")},"data-v-c0f57990",null);t.default=de.exports},ZZXr:function(e,t){},ax3d:function(e,t,n){var s=n("e8AB")("keys"),r=n("3Eo+");e.exports=function(e){return s[e]||(s[e]=r(e))}},bRrM:function(e,t,n){"use strict";var s=n("7KvD"),r=n("FeBl"),i=n("evD5"),o=n("+E39"),a=n("dSzd")("species");e.exports=function(e){var t="function"==typeof r[e]?r[e]:s[e];o&&t&&!t[a]&&i.f(t,a,{configurable:!0,get:function(){return this}})}},bqnK:function(e,t,n){n("HpRW")("Map")},dSzd:function(e,t,n){var s=n("e8AB")("wks"),r=n("3Eo+"),i=n("7KvD").Symbol,o="function"==typeof i;(e.exports=function(e){return s[e]||(s[e]=o&&i[e]||(o?i:r)("Symbol."+e))}).store=s},e6n0:function(e,t,n){var s=n("evD5").f,r=n("D2L2"),i=n("dSzd")("toStringTag");e.exports=function(e,t,n){e&&!r(e=n?e:e.prototype,i)&&s(e,i,{configurable:!0,value:t})}},e8AB:function(e,t,n){var s=n("FeBl"),r=n("7KvD"),i=r["__core-js_shared__"]||(r["__core-js_shared__"]={});(e.exports=function(e,t){return i[e]||(i[e]=void 0!==t?t:{})})("versions",[]).push({version:s.version,mode:n("O4g8")?"pure":"global",copyright:"© 2019 Denis Pushkarev (zloirock.ru)"})},evD5:function(e,t,n){var s=n("77Pl"),r=n("SfB7"),i=n("MmMw"),o=Object.defineProperty;t.f=n("+E39")?Object.defineProperty:function(e,t,n){if(s(e),t=i(t,!0),s(n),r)try{return o(e,t,n)}catch(e){}if("get"in n||"set"in n)throw TypeError("Accessors not supported!");return"value"in n&&(e[t]=n.value),e}},fkB2:function(e,t,n){var s=n("UuGF"),r=Math.max,i=Math.min;e.exports=function(e,t){return(e=s(e))<0?r(e+t,0):i(e,t)}},g2ym:function(e,t){},h65t:function(e,t,n){var s=n("UuGF"),r=n("52gC");e.exports=function(e){return function(t,n){var i,o,a=String(r(t)),l=s(n),c=a.length;return l<0||l>=c?e?"":void 0:(i=a.charCodeAt(l))<55296||i>56319||l+1===c||(o=a.charCodeAt(l+1))<56320||o>57343?e?a.charAt(l):i:e?a.slice(l,l+2):o-56320+(i-55296<<10)+65536}}},hJx8:function(e,t,n){var s=n("evD5"),r=n("X8DO");e.exports=n("+E39")?function(e,t,n){return s.f(e,t,r(1,n))}:function(e,t,n){return e[t]=n,e}},ifoU:function(e,t,n){e.exports={default:n("3C/1"),__esModule:!0}},kM2E:function(e,t,n){var s=n("7KvD"),r=n("FeBl"),i=n("+ZMJ"),o=n("hJx8"),a=n("D2L2"),l=function(e,t,n){var c,u,p,f=e&l.F,d=e&l.G,h=e&l.S,v=e&l.P,m=e&l.B,g=e&l.W,b=d?r:r[t]||(r[t]={}),D=b.prototype,y=d?s:h?s[t]:(s[t]||{}).prototype;for(c in d&&(n=t),n)(u=!f&&y&&void 0!==y[c])&&a(b,c)||(p=u?y[c]:n[c],b[c]=d&&"function"!=typeof y[c]?n[c]:m&&u?i(p,s):g&&y[c]==p?function(e){var t=function(t,n,s){if(this instanceof e){switch(arguments.length){case 0:return new e;case 1:return new e(t);case 2:return new e(t,n)}return new e(t,n,s)}return e.apply(this,arguments)};return t.prototype=e.prototype,t}(p):v&&"function"==typeof p?i(Function.call,p):p,v&&((b.virtual||(b.virtual={}))[c]=p,e&l.R&&D&&!D[c]&&o(D,c,p)))};l.F=1,l.G=2,l.S=4,l.P=8,l.B=16,l.W=32,l.U=64,l.R=128,e.exports=l},lOnJ:function(e,t){e.exports=function(e){if("function"!=typeof e)throw TypeError(e+" is not a function!");return e}},lktj:function(e,t,n){var s=n("Ibhu"),r=n("xnc9");e.exports=Object.keys||function(e){return s(e,r)}},m9gC:function(e,t,n){var s=n("RY/4"),r=n("4WTo");e.exports=function(e){return function(){if(s(this)!=e)throw TypeError(e+"#toJSON isn't generic");return r(this)}}},msXi:function(e,t,n){var s=n("77Pl");e.exports=function(e,t,n,r){try{return r?t(s(n)[0],n[1]):t(n)}catch(t){var i=e.return;throw void 0!==i&&s(i.call(e)),t}}},mvHQ:function(e,t,n){e.exports={default:n("qkKv"),__esModule:!0}},oeOm:function(e,t,n){var s=n("7Doy");e.exports=function(e,t){return new(s(e))(t)}},qCoq:function(e,t,n){"use strict";var s=n("9C8M"),r=n("LIJb");e.exports=n("qo66")("Map",function(e){return function(){return e(this,arguments.length>0?arguments[0]:void 0)}},{get:function(e){var t=s.getEntry(r(this,"Map"),e);return t&&t.v},set:function(e,t){return s.def(r(this,"Map"),0===e?0:e,t)}},s,!0)},qMYg:function(e,t){},qio6:function(e,t,n){var s=n("evD5"),r=n("77Pl"),i=n("lktj");e.exports=n("+E39")?Object.defineProperties:function(e,t){r(e);for(var n,o=i(t),a=o.length,l=0;a>l;)s.f(e,n=o[l++],t[n]);return e}},qkKv:function(e,t,n){var s=n("FeBl"),r=s.JSON||(s.JSON={stringify:JSON.stringify});e.exports=function(e){return r.stringify.apply(r,arguments)}},qo66:function(e,t,n){"use strict";var s=n("7KvD"),r=n("kM2E"),i=n("06OY"),o=n("S82l"),a=n("hJx8"),l=n("xH/j"),c=n("NWt+"),u=n("2KxR"),p=n("EqjI"),f=n("e6n0"),d=n("evD5").f,h=n("ALrJ")(0),v=n("+E39");e.exports=function(e,t,n,m,g,b){var D=s[e],y=D,w=g?"set":"add",_=y&&y.prototype,x={};return v&&"function"==typeof y&&(b||_.forEach&&!o(function(){(new y).entries().next()}))?(y=t(function(t,n){u(t,y,e,"_c"),t._c=new D,void 0!=n&&c(n,g,t[w],t)}),h("add,clear,delete,forEach,get,has,set,keys,values,entries,toJSON".split(","),function(e){var t="add"==e||"set"==e;e in _&&(!b||"clear"!=e)&&a(y.prototype,e,function(n,s){if(u(this,y,e),!t&&b&&!p(n))return"get"==e&&void 0;var r=this._c[e](0===n?0:n,s);return t?this:r})}),b||d(y.prototype,"size",{get:function(){return this._c.size}})):(y=m.getConstructor(t,e,g,w),l(y.prototype,n),i.NEED=!0),f(y,e),x[e]=y,r(r.G+r.W+r.F,x),b||m.setStrong(y,e,g),y}},sB3e:function(e,t,n){var s=n("52gC");e.exports=function(e){return Object(s(e))}},sLJk:function(e,t){},sfEQ:function(e,t){},"vFc/":function(e,t,n){var s=n("TcQ7"),r=n("QRG4"),i=n("fkB2");e.exports=function(e){return function(t,n,o){var a,l=s(t),c=r(l.length),u=i(o,c);if(e&&n!=n){for(;c>u;)if((a=l[u++])!=a)return!0}else for(;c>u;u++)if((e||u in l)&&l[u]===n)return e||u||0;return!e&&-1}}},"vIB/":function(e,t,n){"use strict";var s=n("O4g8"),r=n("kM2E"),i=n("880/"),o=n("hJx8"),a=n("/bQp"),l=n("94VQ"),c=n("e6n0"),u=n("PzxK"),p=n("dSzd")("iterator"),f=!([].keys&&"next"in[].keys()),d=function(){return this};e.exports=function(e,t,n,h,v,m,g){l(n,t,h);var b,D,y,w=function(e){if(!f&&e in M)return M[e];switch(e){case"keys":case"values":return function(){return new n(this,e)}}return function(){return new n(this,e)}},_=t+" Iterator",x="values"==v,k=!1,M=e.prototype,O=M[p]||M["@@iterator"]||v&&M[v],F=O||w(v),I=v?x?w("entries"):F:void 0,S="Array"==t&&M.entries||O;if(S&&(y=u(S.call(new e)))!==Object.prototype&&y.next&&(c(y,_,!0),s||"function"==typeof y[p]||o(y,p,d)),x&&O&&"values"!==O.name&&(k=!0,F=function(){return O.call(this)}),s&&!g||!f&&!k&&M[p]||o(M,p,F),a[t]=F,a[_]=d,v)if(b={values:x?F:w("values"),keys:m?F:w("keys"),entries:I},g)for(D in b)D in M||i(M,D,b[D]);else r(r.P+r.F*(f||k),t,b);return b}},xGkn:function(e,t,n){"use strict";var s=n("4mcu"),r=n("EGZi"),i=n("/bQp"),o=n("TcQ7");e.exports=n("vIB/")(Array,"Array",function(e,t){this._t=o(e),this._i=0,this._k=t},function(){var e=this._t,t=this._k,n=this._i++;return!e||n>=e.length?(this._t=void 0,r(1)):r(0,"keys"==t?n:"values"==t?e[n]:[n,e[n]])},"values"),i.Arguments=i.Array,s("keys"),s("values"),s("entries")},"xH/j":function(e,t,n){var s=n("hJx8");e.exports=function(e,t,n){for(var r in t)n&&e[r]?e[r]=t[r]:s(e,r,t[r]);return e}},"xgs/":function(e,t){},xnc9:function(e,t){e.exports="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(",")},zQR9:function(e,t,n){"use strict";var s=n("h65t")(!0);n("vIB/")(String,"String",function(e){this._t=String(e),this._i=0},function(){var e,t=this._t,n=this._i;return n>=t.length?{value:void 0,done:!0}:(e=s(t,n),this._i+=e.length,{value:e,done:!1})})},zffa:function(e,t){}});
//# sourceMappingURL=0.c5d6f0d13af72f9607c3.js.map